---
  # Automation. See: https://www.home-assistant.io/integrations/automation/
  # Trigger. See: https://www.home-assistant.io/docs/automation/trigger/
  # Conditions. See: https://www.home-assistant.io/docs/automation/condition/
  # Actions. See: https://www.home-assistant.io/docs/automation/action/

  # Related entities:
  #
  # - sun.sun                                 : To determine sun elevation
  # - input_boolean.nightlights_enable        : Logic switch to enable/disable night light automations
  
  # Automation description:
  #
  # When the sun elevatin goes below a preset value (e.g. -0.5) the input_boolean.nightlights_enable switches 'on'
  # Inversely, when the sun rises above a preset value (e.g. -0.5) the input_boolean.nightlights_enable witches 'off'
  # These automations are also triggered at startup of HA and a condition clause is used to determine whether to
  # switch input_boolean.nightlights_enable 'on' or 'off' in this case.

  - alias: AAV Avond [start]
    trigger:
      - platform: numeric_state
        entity_id: sun.sun
        attribute: elevation
        below: -0.5
      - platform: homeassistant
        event: start
    condition:
      condition: template
      value_template: "{{ state_attr('sun.sun', 'elevation') < -0.5 }}"
    action:
      - service: input_boolean.turn_on
        data:
          entity_id: input_boolean.nightlights_enable

  - alias: AAV Avond [finish]
    trigger:
      - platform: numeric_state
        entity_id: sun.sun
        attribute: elevation
        above: -0.5
      - platform: homeassistant
        event: start
    condition:
      condition: template
      value_template: "{{ state_attr('sun.sun', 'elevation') > -0.5 }}"
    action:
      - service: input_boolean.turn_off
        data:
          entity_id: input_boolean.nightlights_enable
